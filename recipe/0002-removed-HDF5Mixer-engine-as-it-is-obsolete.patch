From 117e070db120fa4d9ff64adf1b8b7ede87b7fa58 Mon Sep 17 00:00:00 2001
From: Junmin Gu <jgu@lbl.gov>
Date: Tue, 14 Sep 2021 12:12:22 -0700
Subject: [PATCH 2/4] removed HDF5Mixer engine as it is obsolete

---
 source/adios2/CMakeLists.txt  |  7 -------
 source/adios2/core/IO.cpp     |  2 --
 source/adios2/core/IOHDF5.cpp | 12 ------------
 3 files changed, 21 deletions(-)

diff --git a/source/adios2/CMakeLists.txt b/source/adios2/CMakeLists.txt
index 2b3a84447..443e310a3 100644
--- a/source/adios2/CMakeLists.txt
+++ b/source/adios2/CMakeLists.txt
@@ -260,13 +260,6 @@ if(ADIOS2_HAVE_HDF5)
     engine/hdf5/HDF5WriterP.cpp
     toolkit/interop/hdf5/HDF5Common.cpp toolkit/interop/hdf5/HDF5Common.tcc
     )
-  if(NOT HDF5_VERSION VERSION_LESS 1.11)
-    target_sources(adios2_hdf5 PRIVATE
-      engine/mixer/HDFMixer.cpp
-      engine/mixer/HDFMixer.tcc
-      engine/mixer/HDFMixerWriter.cpp
-      )
-  endif()
   target_link_libraries(adios2_core PRIVATE adios2_hdf5)
   set_property(TARGET adios2_hdf5 PROPERTY EXPORT_NAME hdf5)
   set_property(TARGET adios2_hdf5 PROPERTY OUTPUT_NAME adios2${ADIOS2_LIBRARY_SUFFIX}_hdf5)
diff --git a/source/adios2/core/IO.cpp b/source/adios2/core/IO.cpp
index af026ab02..5b340489d 100644
--- a/source/adios2/core/IO.cpp
+++ b/source/adios2/core/IO.cpp
@@ -54,7 +54,6 @@ namespace adios2
 namespace core
 {
 
-IO::EngineFactoryEntry IO_MakeEngine_HDFMixer();
 IO::EngineFactoryEntry IO_MakeEngine_HDF5();
 
 namespace
@@ -67,7 +66,6 @@ std::unordered_map<std::string, IO::EngineFactoryEntry> Factory = {
      {IO::MakeEngine<engine::BP4Reader>, IO::MakeEngine<engine::BP4Writer>}},
     {"hdfmixer",
 #ifdef ADIOS2_HAVE_HDF5
-     IO_MakeEngine_HDFMixer()
 #else
      IO::NoEngineEntry("ERROR: this version didn't compile with "
                        "HDF5 library, can't use HDF5 engine\n")
diff --git a/source/adios2/core/IOHDF5.cpp b/source/adios2/core/IOHDF5.cpp
index 92c589654..f4df62caa 100644
--- a/source/adios2/core/IOHDF5.cpp
+++ b/source/adios2/core/IOHDF5.cpp
@@ -9,9 +9,6 @@
 
 #include "adios2/engine/hdf5/HDF5ReaderP.h"
 #include "adios2/engine/hdf5/HDF5WriterP.h"
-#if H5_VERSION_GE(1, 11, 0)
-#include "adios2/engine/mixer/HDFMixer.h"
-#endif
 
 namespace adios2
 {
@@ -37,15 +34,6 @@ std::shared_ptr<Engine> MakeEngineHDF5(IO &io, const std::string &name,
 
 } // end anonymous namespace
 
-IO::EngineFactoryEntry IO_MakeEngine_HDFMixer()
-{
-#if H5_VERSION_GE(1, 11, 0)
-    return IO::EngineFactoryEntry{MakeEngineHDF5<engine::HDF5ReaderP>,
-                                  MakeEngineHDF5<engine::HDFMixer>};
-#else
-    return IO::NoEngineEntry("ERROR: update HDF5 >= 1.11 to support VDS.");
-#endif
-}
 
 IO::EngineFactoryEntry IO_MakeEngine_HDF5()
 {
-- 
2.25.1

